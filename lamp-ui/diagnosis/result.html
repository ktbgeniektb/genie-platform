<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è¨ºæ–­çµæœ</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <link rel="stylesheet" href="./../css/diagnosis_result.css" />
  </head>
  <body>
    <section class="result-header">
      <div class="header-image-container">
        <img id="top-image" src="" alt="è¨ºæ–­çµæœç”»åƒ" />
        <div class="result-overlay-text">
          <div class="main-type-wrapper">
            <h1 id="main-type"></h1>
          </div>
          <div class="description-wrapper">
            <p id="description"></p>
          </div>
        </div>
      </div>
    </section>

    <section class="chart">
      <canvas id="result-chart"></canvas>
    </section>

    <section class="result-section">
      <h2>ğŸ” ç‰¹å¾´</h2>
      <ul id="features"></ul>
    </section>

    <section class="result-section">
      <h2>ğŸŒ± ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã‚„ã™ã„ç¬é–“</h2>
      <ul id="moments"></ul>
    </section>

    <section class="result-section">
      <h2>ğŸ¯ æ´»ã‹ã™ãƒ’ãƒ³ãƒˆ</h2>
      <ul id="tips"></ul>
    </section>

    <section class="result-section">
      <h2>ğŸ” ã‚ãªãŸã®ä¸­ã«ã€ã“ã‚“ãªå´é¢ã‚‚â€¦</h2>
      <p id="sub"></p>
    </section>

    <!-- <a class="ai" href="http://localhost:8000/interview" target="_blank">
      AIé¢è«‡ã§æ·±æ˜ã‚Šã™ã‚‹
    </a> -->
    <section class="sns-share">
      <h2>ğŸ“¢ çµæœã‚’ã‚·ã‚§ã‚¢ã—ã‚ˆã†ï¼</h2>
      <a id="twitter-share" class="sns-btn" target="_blank">Twitterã§ã‚·ã‚§ã‚¢</a>
      <a id="line-share" class="sns-btn" target="_blank">LINEã§é€ã‚‹</a>
    </section>
  </body>
  <script type="module">
    import { templates } from "../js/template.js";
    import { firebaseConfig } from "../js/firebaseConfig.js";
    import {
      renderFromFirestore,
      renderFromLocalStorage,
    } from "../js/render.js";

    const id = new URLSearchParams(window.location.search).get("id");

    if (id) {
      renderFromFirestore(id, firebaseConfig, templates);
    } else {
      renderFromLocalStorage(templates);
    }
  </script>
  <script>
    $(function () {
      const currentUrl = location.href;
      const top1 = localStorage.getItem("top1");
      const top2 = localStorage.getItem("top2");
      const typeMap = {
        kyomei: "å…±é³´å‹",
        tankyu: "æ¢æ±‚å‹",
        hyougen: "è¡¨ç¾å‹",
        taiken: "ä½“é¨“å‹",
        chosen: "æŒ‘æˆ¦å‹",
      };
      const text = `ç§ã®ãƒ“ã‚¸ãƒ§ãƒ³ã®æºæ³‰ã¯ã€Œ${typeMap[top1]} Ã—
  ${typeMap[top2]}ã€ï¼ã‚ãªãŸã‚‚è¨ºæ–­ã—ã¦ã¿ã‚ˆã†ğŸ‘‡`;
      const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(
        text
      )}&url=${encodeURIComponent(currentUrl)}`;
      const lineUrl = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(
        currentUrl
      )}`;
      $("#twitter-share").attr("href", twitterUrl);
      $("#line-share").attr("href", lineUrl);
    });
  </script>
</html>
